<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Hotel List</title>
  <style>
    body{margin:1em;font-family:system-ui;background:#fff;color:#000}
    table{border-collapse:collapse;width:100%}
    th,td{border:1px solid #ccc;padding:.4em .6em;text-align:left}
    th{cursor:pointer}
  </style>
</head>
<body>
  <h1>Hotel List</h1>

  <table id="t">
    <thead>
      <tr>
        <th>Hotel</th>
        <th>Area&nbsp;/&nbsp;Town</th>
        <th>Full&nbsp;Address</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
const jsonPath = './hotels_geocoded.json';
const tbody    = document.querySelector('#t tbody');
let hotels = [];

/* tiny fallback for empty Area/Town */
const AREA_FALLBACK = '—';

fetch(jsonPath)
  .then(r => r.json())
  .then(data => {
    // patch any missing Area/Town
    hotels = data.map(h => ({
      ...h,
      Area: h.Area?.trim() ? h.Area :
            h.Address?.includes(',') ?
            h.Address.split(',').reverse().find(p => p.trim())?.trim() || AREA_FALLBACK
            : AREA_FALLBACK
    }));
    render('Name');            // initial A→Z
  })
  .catch(console.error);

/* column sort ( first click A→Z, second click Z→A, third reverts to A→Z) */
let direction = -1;  // 1 ascending, -1 descending
function render(key){
  direction *= -1;
  tbody.innerHTML = '';
  hotels.slice()
    .sort((a,b)=> a[key].localeCompare(b[key],'en',{sensitivity:'base'}) * direction)
    .forEach(h=>{
      tbody.insertAdjacentHTML('beforeend',`
        <tr>
          <td>${h.Name}</td>
          <td>${h.Area}</td>
          <td>${h.Address}</td>
        </tr>`);
    });
}
document.querySelectorAll('th').forEach(th=>{
  th.addEventListener('click', ()=>render(th.textContent.trim()));
});
</script>
</body>
</html>
