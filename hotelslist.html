<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Hotel List</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body{margin:0;font-family:'Roboto',sans-serif; background:#fff;color:#000;font-size:0.875rem;line-height:1.5}

    h2{margin:.5em 0;text-align:center;color:#388DCD;font-weight:700}
    .copy{text-align:center;margin:0 0 1em}

    table{font-size:0.875rem;border-collapse:collapse;width:100%;background:#fff}
    th,td{border:1px solid #ccc;padding:.5em .8em}
    th{background:#388DCD;color:#fff;cursor:pointer;position:relative}
    td{background:#fff}  /* default white */
    tr:nth-child(odd) td{background:#f5f5f5} /* alternating grey */
    td.colored{background:#f5f5f5}

    .arrows {font-size:0.75em;float:right;opacity:0.4}
    th.asc .arrow:after{content: '↑';opacity:1}
    th.desc .arrow:after{content: '↓';opacity:1}
  </style>
</head>
<body>

  <h2>Hotels List</h2>
  <p class="copy">
    Below is a list of every Hotel/HMO identified on the map. You can sort by area to see which ones are near you.
    Addresses are also included.
  </p>

  <table id="t">
    <thead>
      <tr>
        <th data-col="Name">Hotel</th>
        <th data-col="Area">Area</th>
        <th data-col="Address">Full Address</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
const jsonPath = './hotels_geocoded.json';
const tbody = document.querySelector('#t tbody');
let hotels = [];
const AREA_FALLBACK = '—';
let current = {col:'Name',dir:1};

fetch(jsonPath)
  .then(r => r.json())
  .then(data => {
    hotels = data.map(h => ({
      ...h,
        Area: h.Area?.trim() ? h.Area :
            h.Address?.split(',').slice(-2)[0]?.trim() ||
            h.Address?.split(',').slice(-3)[0]?.trim() ||
            AREA_FALLBACK
    }));
    hotels.sort((a,b)=> a.Name.localeCompare(b.Name,'en',{sensitivity:'base'}));
    render('Name',1);
  })
  .catch(console.error);

const isEmptyArea = s => !s || !/[A-Za-z]/.test(s);
function render(col,dir){
  dir = dir ?? current.dir;             // preserve direction toggle
  if(col===current.col){ current.dir*=-1; } else { current={col,dir:1}; }

  document.querySelectorAll('#t th').forEach(th=> th.classList.remove('asc','desc'));
  if(col===current.col){ th.classList.add(current.dir>0?'asc':'desc'); }

  tbody.innerHTML='';
  hotels
    .slice()
    .sort((a,b)=>{
        const A = isEmptyArea(a[col]);
        const B = isEmptyArea(b[col]);
        if(A && !B) return 1;
        if(!A && B) return -1;
        if(A && B) return 0;
        return a[col].localeCompare(b[col],undefined,{sensitivity:'base'}) * current.dir;
  })
  .forEach(h=>tbody.insertAdjacentHTML('beforeend',
    `<tr><td>${h.Name}</td><td>${h.Area}</td><td>${h.Address}</td></tr>`)
  );
}
</script>
</body>
</html>
