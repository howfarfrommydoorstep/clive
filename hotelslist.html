<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Hotel List</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body{margin:0;font-family:'Roboto',sans-serif; background:#fff;color:#000;font-size:0.875rem;line-height:1.5}

    h2{margin:.5em 0;text-align:center;color:#388DCD;font-weight:700}
    .copy{text-align:center;margin:0 0 1em}

    table{font-size:0.875rem;border-collapse:collapse;width:100%;background:#fff}
    th,td{border:1px solid #ccc;padding:.5em .8em}
    th{background:#388DCD;color:#fff;cursor:pointer;position:relative}
    td{background:#fff}  /* default white */
    tr:nth-child(odd) td{background:#f5f5f5} /* alternating grey */
    td.colored{background:#f5f5f5}

    .arrows {font-size:0.75em;float:right;opacity:0.4}
    th.asc .arrow:after{content: '↑';opacity:1}
    th.desc .arrow:after{content: '↓';opacity:1}
  </style>
</head>
<body>

  <h2 style="color:#000 !important">Hotels List</h2>
  <p class="copy">
    Below is a list of every Hotel / HMO identified on the map.
    Sort by area to see which ones are near you. Addresses are included.
  </p>

  <table id="t">
    <thead>
      <tr>
        <th data-col="Name">Hotel <span class="arrow">&#8595;</span></th>
        <th data-col="Area">Area <span class="arrow">&#8595;</span></th>
        <th data-col="Address">Full Address <span class="arrow">&#8595;</span></th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const jsonUrl   = './hotels_geocoded.json';
    const tbody     = document.querySelector('#t tbody');
    let hotels      = [];
    let currentSort = { col: null, dir: 1 };

    fetch(jsonUrl)
      .then(r => r.json())
      .then(raw => {
        hotels = raw.map(h => ({
          Name:  h.Name  || '',
          Area:  h.Area  || '--',
          Address: h.Address || ''
        }));
        render();
      })
      .catch(err => {
        console.error(err);
        tbody.innerHTML = `<tr><td colspan="3" style="text-align:center;">Failed to load data</td></tr>`;
      });

    function render(col = 'Name', dir = 1) {
      if (col !== currentSort.col) {
        currentSort = { col, dir: 1 };
      } else {
        currentSort.dir *= -1;
      }

      // sort
      hotels.sort((a, b) => {
        let x = a[currentSort.col], y = b[currentSort.col];
        x = x?.toLowerCase?.() || x;
        y = y?.toLowerCase?.() || y;
        return x < y ? -currentSort.dir : x > y ? currentSort.dir : 0;
      });

      // clear tbody
      tbody.innerHTML = '';
      hotels.forEach(h => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${h.Name}</td>
          <td>${h.Area}</td>
          <td>${h.Address}</td>
        `;
        tbody.appendChild(tr);
      });

      // arrows
      document.querySelectorAll('#t th').forEach(th => {
        const span = th.querySelector('.arrow');
        const isCur = th.dataset.col === currentSort.col;
        th.classList.toggle('asc',  isCur && currentSort.dir > 0);
        th.classList.toggle('desc', isCur && currentSort.dir < 0);
        span.textContent = (!isCur || currentSort.dir > 0) ? '\u2193' : '\u2191';
      });
    }

    // click handler on headers
    document.querySelector('#t thead').addEventListener('click', e => {
      const th = e.target.closest('th');
      if (th) render(th.dataset.col);
    });
  </script>
</body>
</html>
