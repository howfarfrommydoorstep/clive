<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Hotel List</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body{margin:0;font-family:'Roboto',sans-serif;background:#fff;color:#000;font-size:.875rem;line-height:1.5}
    .pad{padding-inline:clamp(.75rem,3vw,2.5rem)}
    table{width:100%;border-collapse:collapse;font-size:.875rem;background:#fff}
    th,td{border:1px solid #ccc;padding:.5em .8em}
    th{background:#388DCD;color:#fff;cursor:pointer}
    tr:nth-child(odd) td{background:#f5f5f5}
    .arrow{font-size:.75em;opacity:.7}
    th.asc .arrow:after{content:'↑';opacity:1}
    th.desc .arrow:after{content:'↓';opacity:1}
  </style>
</head>
<body style="display:grid;gap:1.2rem;place-items:center;margin:0">
  <h1 style="margin:0;text-align:center;font-weight:700;font-size:clamp(1.8rem,4vw,2.6rem);color:#000">
    Hotels List
  </h1>
  <p style="margin:0;text-align:center;color:#555;font-size:clamp(.95rem,2.6vw,1.15rem)">
    Below is every Hotel / HMO identified on the map.  
    Click a column to sort by area or address.
  </p>

  <div class="pad" style="width:100%">
    <table id="t">
      <thead>
        <tr>
          <th data-col="Name">Hotel&nbsp;<span class="arrow"></span></th>
          <th data-col="Area">Area&nbsp;<span class="arrow"></span></th>
          <th data-col="Address">Full Address&nbsp;<span class="arrow"></span></th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

 <script>
const jsonUrl   = './hotels_geocoded.json';
const tbody     = document.querySelector('#t tbody');
let hotels      = [];
let curSort     = {col:'Name',dir:1};

fetch(jsonUrl)
  .then(r => r.json())
  .then(raw => {
    hotels = raw.map(h => ({Name:h.Name||'',Area:h.Area?.trim()||'',Address:h.Address||''}));
    draw();
  })
  .catch(()=>tbody.innerHTML='<tr><td colspan="3" style="text-align:center">Failed to load data</td></tr>');

function draw(col='Name',dir=1) {
  if (col === curSort.col) dir = (curSort.dir *= -1);
  else                     dir = (curSort = {col,dir:1}).dir;

  hotels.sort((a,b)=>{
    let x=a[col], y=b[col];
    // blank/missing last
    const xBlank = (!x || /^\s*$/.test(String(x)));
    const yBlank = (!y || /^\s*$/.test(String(y)));
    if (xBlank && !yBlank) return  dir;
    if (yBlank && !xBlank) return -dir;
    if (xBlank && yBlank)  return 0;
    // text compare
    x = String(x).toLowerCase();
    y = String(y).toLowerCase();
    return x.localeCompare(y,'en',{numeric:true}) * dir;
  });

  tbody.innerHTML = '';
  hotels.forEach(h=>{
    const tr=document.createElement('tr');
    tr.innerHTML=
      `<td>${h.Name}</td><td>${h.Area || '—'}</td><td>${h.Address}</td>`;
    tbody.appendChild(tr);
  });

  // arrow indicators
  document.querySelectorAll('#t th').forEach(th=>{
    const sp=th.querySelector('.arrow');
    th.classList.toggle('asc',th.dataset.col===col && dir>0);
    th.classList.toggle('desc',th.dataset.col===col && dir<0);
    sp.textContent = (th.dataset.col===col && dir<0)?'↑':'↓';
  });
}
document.querySelector('#t thead').addEventListener('click',e=>{
  const th=e.target.closest('th');
  th && draw(th.dataset.col);
});
</script>
</body>
</html>
