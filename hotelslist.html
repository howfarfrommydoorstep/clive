<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Hotel list – alphabetised</title>
  <style>body{margin:0;padding:1em;font-family:system-ui;background:#fff;color:#000}</style>
</head>

<body>
  <h1>Hotel list (alphabetised – Nominatim 60/day)</h1>
  <table id="t" border="1">
    <thead>
      <tr><th>Hotel</th><th>Address</th><th>Town</th></tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const jsonPath = './hotels.json';
    const nomin   = 'https://nominatim.openstreetmap.org/reverse?format=jsonv2&addressdetails=1';

    document.addEventListener('DOMContentLoaded', () => {
      fetch(jsonPath)
        .then(r => r.json())
        .then(data => {
          const hotels = data;   // it's the array itself
          const tbody = document.querySelector('#t tbody');

          hotels.forEach((h,i) => {
            const url = `${nomin}&lat=${h.Latitude}&lon=${h.Longitude}`;
            fetch(url)
              .then(r => r.json())
              .then(geo => {
                const addr = geo.display_name || '';
                const town = geo.address.city || geo.address.town || geo.address.village || '-';
                tbody.insertAdjacentHTML(
                  'beforeend',
                  `<tr>
                    <td>${h.Name}</td>
                    <td>${addr}</td>
                    <td>${town}</td>
                  </tr>`
                );
              })
              .catch(() => tbody.insertAdjacentHTML('beforeend', `<tr><td>${h.Name}</td><td>—</td><td>—</td></tr>`));
            if(i < hotels.length-1) setTimeout(()=>{}, 1100);     // 1 call/ second
            else setTimeout(() => document.title += ' ✓ done', 0);
          });
        })
        .catch(console.warn);
    });
  </script>
</body>
</html>
